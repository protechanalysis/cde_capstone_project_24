[2024-11-20T23:44:16.664+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2024-11-20T23:44:16.689+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: capstone.tables_joining manual__2024-11-20T23:36:46.718095+00:00 [queued]>
[2024-11-20T23:44:16.702+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: capstone.tables_joining manual__2024-11-20T23:36:46.718095+00:00 [queued]>
[2024-11-20T23:44:16.702+0000] {taskinstance.py:2865} INFO - Starting attempt 2 of 4
[2024-11-20T23:44:16.730+0000] {taskinstance.py:2888} INFO - Executing <Task(PythonOperator): tables_joining> on 2024-11-20 23:36:46.718095+00:00
[2024-11-20T23:44:16.740+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=344) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2024-11-20T23:44:16.743+0000] {standard_task_runner.py:72} INFO - Started process 346 to run task
[2024-11-20T23:44:16.744+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'capstone', 'tables_joining', 'manual__2024-11-20T23:36:46.718095+00:00', '--job-id', '93', '--raw', '--subdir', 'DAGS_FOLDER/capstone_***/country.py', '--cfg-path', '/tmp/tmp7xfcq9er']
[2024-11-20T23:44:16.748+0000] {standard_task_runner.py:105} INFO - Job 93: Subtask tables_joining
[2024-11-20T23:44:16.829+0000] {task_command.py:467} INFO - Running <TaskInstance: capstone.tables_joining manual__2024-11-20T23:36:46.718095+00:00 [running]> on host e9fd75a7ea89
[2024-11-20T23:44:16.976+0000] {taskinstance.py:3131} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='adewunmi' AIRFLOW_CTX_DAG_ID='capstone' AIRFLOW_CTX_TASK_ID='tables_joining' AIRFLOW_CTX_EXECUTION_DATE='2024-11-20T23:36:46.718095+00:00' AIRFLOW_CTX_TRY_NUMBER='2' AIRFLOW_CTX_DAG_RUN_ID='manual__2024-11-20T23:36:46.718095+00:00'
[2024-11-20T23:44:16.978+0000] {taskinstance.py:731} INFO - ::endgroup::
[2024-11-20T23:44:16.999+0000] {capstone_function.py:356} INFO - Starting the table joining process.
[2024-11-20T23:44:16.999+0000] {capstone_function.py:128} INFO - Starting column selection process.
[2024-11-20T23:44:27.430+0000] {capstone_function.py:110} INFO - Successfully read Parquet file from S3.
[2024-11-20T23:44:27.431+0000] {capstone_function.py:138} INFO - Data loaded successfully from S3.
[2024-11-20T23:44:27.435+0000] {capstone_function.py:161} INFO - Column selection completed successfully.
[2024-11-20T23:44:27.439+0000] {capstone_function.py:175} INFO - Starting currency extraction process.
[2024-11-20T23:44:36.695+0000] {capstone_function.py:110} INFO - Successfully read Parquet file from S3.
[2024-11-20T23:44:36.697+0000] {capstone_function.py:185} INFO - Data loaded successfully from S3.
[2024-11-20T23:44:36.698+0000] {capstone_function.py:193} INFO - Filtering currency symbol columns and joining with country names.
[2024-11-20T23:44:36.738+0000] {capstone_function.py:201} INFO - Melting the data to extract currency codes and symbols.
[2024-11-20T23:44:36.776+0000] {capstone_function.py:209} INFO - Removing rows with null currency symbols.
[2024-11-20T23:44:36.821+0000] {capstone_function.py:215} INFO - Cleaning up currency codes.
[2024-11-20T23:44:36.824+0000] {capstone_function.py:219} INFO - Grouping by country & aggregating by symbols and codes.
[2024-11-20T23:44:36.864+0000] {capstone_function.py:231} INFO - Currency extraction completed successfully.
[2024-11-20T23:44:36.872+0000] {capstone_function.py:245} INFO - Starting currency name extraction process.
[2024-11-20T23:44:58.760+0000] {capstone_function.py:110} INFO - Successfully read Parquet file from S3.
[2024-11-20T23:44:58.762+0000] {capstone_function.py:255} INFO - Data loaded successfully from S3.
[2024-11-20T23:44:58.763+0000] {capstone_function.py:258} INFO - Filtering country names and currency name columns.
[2024-11-20T23:44:58.801+0000] {capstone_function.py:264} INFO - Melting data to extract currency names.
[2024-11-20T23:44:58.832+0000] {capstone_function.py:270} INFO - Removing rows with null currency names.
[2024-11-20T23:44:58.874+0000] {capstone_function.py:279} INFO - Grouping by country and aggregating currency names.
[2024-11-20T23:44:58.898+0000] {capstone_function.py:286} INFO - Currency name extraction completed successfully.
[2024-11-20T23:44:58.905+0000] {capstone_function.py:301} INFO - Starting language extraction process.
[2024-11-20T23:45:02.235+0000] {capstone_function.py:110} INFO - Successfully read Parquet file from S3.
[2024-11-20T23:45:02.237+0000] {capstone_function.py:311} INFO - Data loaded successfully from S3.
[2024-11-20T23:45:02.238+0000] {capstone_function.py:314} INFO - Filtering country names and language columns.
[2024-11-20T23:45:02.274+0000] {capstone_function.py:320} INFO - Melting data to extract languages.
[2024-11-20T23:45:02.302+0000] {capstone_function.py:325} INFO - Removing rows with null language values.
[2024-11-20T23:45:02.341+0000] {capstone_function.py:334} INFO - Grouping by country and aggregating languages.
[2024-11-20T23:45:02.367+0000] {capstone_function.py:341} INFO - Language extraction completed successfully.
[2024-11-20T23:45:02.375+0000] {capstone_function.py:365} INFO - Joining tables.
[2024-11-20T23:45:02.393+0000] {capstone_function.py:378} INFO - Tables joined successfully.
[2024-11-20T23:45:02.394+0000] {python.py:240} INFO - Done. Returned value was:      independent  ...                                          languages
0           True  ...                              Dari, Pashto, Turkmen
1           True  ...                                           Albanian
2           True  ...                                             Arabic
3          False  ...                                    English, Samoan
4           True  ...                                            Catalan
..           ...  ...                                                ...
244        False  ...                         Spanish, Berber, Hassaniya
245         True  ...                                             Arabic
246         True  ...                                            English
247         True  ...  English, Sotho, Tswana, Tsonga, Venda, Xhosa, ...
248        False  ...                                            Swedish

[249 rows x 18 columns]
[2024-11-20T23:45:02.492+0000] {taskinstance.py:340} INFO - ::group::Post task execution logs
[2024-11-20T23:45:02.493+0000] {taskinstance.py:352} INFO - Marking task as SUCCESS. dag_id=capstone, task_id=tables_joining, run_id=manual__2024-11-20T23:36:46.718095+00:00, execution_date=20241120T233646, start_date=20241120T234416, end_date=20241120T234502
[2024-11-20T23:45:02.548+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 0
[2024-11-20T23:45:02.579+0000] {taskinstance.py:3900} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2024-11-20T23:45:02.583+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
